<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lazyfox AI - AI Conversations (Deepseek V3)</title>
    <meta name="description" content="Engage in intelligent conversations with Lazyfox AI, powered by the Deepseek V3 Turbo model via Novita.ai. Features highlight.js syntax highlighting and copy-to-clipboard for code blocks.">
    <meta name="keywords" content="AI chat, chatbot, Novita.ai, DeepSeek V3 Turbo, artificial intelligence, conversation AI, highlight.js, syntax highlighting">
    <meta name="author" content="Lazyfox AI">
    <!-- <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>🦊</text></svg>"> -->
     <link rel="shortcut icon" href="./assets/img/logo/lazyfox.png" type="image/x-icon">
    <meta property="og:title" content="Lazyfox AI - AI Conversations">
    <meta property="og:description" content="Engage in intelligent conversations with Lazyfox AI, powered by the Deepseek V3 Turbo model.">
    <meta property="og:image" content="https://placehold.co/1200x630/1f2937/a7f3d0?text=Lazyfox+AI">
    <meta property="og:url" content="YOUR_WEBSITE_URL_HERE"> <meta property="og:type" content="website">


    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* Custom scrollbar */
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background-color: rgba(16, 185, 129, 0.6); border-radius: 20px; border: 2px solid transparent; background-clip: content-box; }
        ::-webkit-scrollbar-thumb:hover { background-color: rgba(5, 150, 105, 0.8); }

        /* Base transitions */
        body { transition: background-color 0.3s ease, color 0.3s ease; }

        /* Chat UI Enhancements */
        #chat-history {
            background-color: #f9fafb; /* Lighter gray for light mode */
            border-radius: 0.5rem 0.5rem 0 0; /* Rounded top corners */
        }
        .dark #chat-history {
            background-color: #1f2937; /* Darker gray for dark mode */
        }
        .user-message {
            background-color: #dcfce7; /* Lighter Emerald */
            align-self: flex-end;
            border-radius: 1rem 1rem 0.25rem 1rem; /* Bubble shape */
        }
        .dark .user-message {
            background-color: #047857; /* Darker Emerald */
        }
        .ai-message {
            background-color: #f3f4f6; /* Gray-100 */
            align-self: flex-start;
            max-width: 90%;
            border-radius: 1rem 1rem 1rem 0.25rem; /* Bubble shape */
        }
        .dark .ai-message {
            background-color: #4b5563; /* Slightly lighter gray-600 */
        }
        #user-input {
             border-radius: 9999px; /* Fully rounded */
             box-shadow: inset 0 1px 2px rgba(0,0,0,0.05);
             transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }
         #user-input:focus {
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.3); /* Emerald focus ring */
            border-color: #10b981; /* Emerald border */
         }
        .dark #user-input:focus {
            box-shadow: 0 0 0 2px rgba(52, 211, 153, 0.4); /* Lighter Emerald focus ring */
            border-color: #34d399;
        }
        #send-button {
            transition: background-color 0.2s ease, transform 0.1s ease;
        }
        #send-button:hover {
            transform: scale(1.05);
        }
        #send-button:active {
            transform: scale(0.98);
        }

        /* Loading indicator */
        .loader { border: 4px solid #f3f4f6; border-top: 4px solid #10b981; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin-left: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* highlight.js Code Block Styling */
        .ai-message pre { position: relative; margin: 0.75rem 0; padding: 1rem; padding-top: 2.5rem; border-radius: 0.5rem; background: #282c34; /* atom-one-dark background */ white-space: pre-wrap; word-wrap: break-word; max-height: 500px; overflow-y: auto; }
        /* Light theme override for pre background for better contrast */
        body:not(.dark) .ai-message pre { background: #f3f4f6; /* gray-100 */ border: 1px solid #e5e7eb; /* gray-200 */ }
        .ai-message pre code.hljs { padding: 0; background: none; display: block; white-space: pre-wrap; color: #abb2bf; /* Default atom-one-dark text */ }
        /* Light theme override for code text color */
        body:not(.dark) .ai-message pre code.hljs { color: #1f2937; /* gray-800 */ }
        /* Ensure specific highlight elements are visible in light mode (add more as needed) */
        body:not(.dark) .ai-message pre code.hljs .hljs-keyword { color: #9b59b6; } /* Example: Purple for keywords */
        body:not(.dark) .ai-message pre code.hljs .hljs-string { color: #2ecc71; } /* Example: Green for strings */
        body:not(.dark) .ai-message pre code.hljs .hljs-number { color: #e67e22; } /* Example: Orange for numbers */
        body:not(.dark) .ai-message pre code.hljs .hljs-comment { color: #95a5a6; } /* Example: Gray for comments */
        body:not(.dark) .ai-message pre code.hljs .hljs-title { color: #3498db; } /* Example: Blue for titles/functions */
        body:not(.dark) .ai-message pre code.hljs .hljs-section { color: #e74c3c; } /* Example: Red for sections (like in .htaccess) */
        body:not(.dark) .ai-message pre code.hljs .hljs-attribute { color: #f1c40f; } /* Example: Yellow for attributes */


        /* Copy button */
        .copy-code-button { position: absolute; top: 0.5rem; right: 0.5rem; background-color: rgba(75, 85, 99, 0.7); color: #e5e7eb; border: none; padding: 0.3rem 0.6rem; border-radius: 0.375rem; cursor: pointer; font-size: 0.8rem; opacity: 0.6; transition: opacity 0.2s ease, background-color 0.2s ease; z-index: 10; }
        .copy-code-button:hover { opacity: 1; background-color: rgba(55, 65, 81, 0.9); }
        .copy-code-button i { margin-right: 0.3rem; }
        .copy-code-button.copied { background-color: rgba(16, 185, 129, 0.8); color: white; }

        /* Feature card blur */
        .feature-card { background-color: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.2); }
        .dark .feature-card { background-color: rgba(31, 41, 55, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }

        /* Navbar scroll effect */
        nav { transition: background-color 0.3s ease, backdrop-filter 0.3s ease, -webkit-backdrop-filter 0.3s ease, box-shadow 0.3s ease; }
        nav.scrolled { background-color: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
        .dark nav.scrolled { background-color: rgba(31, 41, 55, 0.7); }

        /* Back to top button */
        #back-to-top { position: fixed; bottom: 20px; right: 20px; display: none; background-color: #10b981; color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; transition: opacity 0.3s ease, visibility 0.3s ease, transform 0.3s ease; opacity: 0; visibility: hidden; z-index: 100; box-shadow: 0 2px 5px rgba(0,0,0,0.3); transform: translateY(10px); }
        #back-to-top.show { display: flex; align-items: center; justify-content: center; opacity: 1; visibility: visible; transform: translateY(0); }
        #back-to-top:hover { background-color: #059669; transform: scale(1.1); }

        /* General Lazy Load Animation */
        .lazy-load { opacity: 0; transform: translateY(30px); transition: opacity 0.8s ease-out, transform 0.8s ease-out; }
        .lazy-load.visible { opacity: 1; transform: translateY(0); }
        /* Stagger feature cards */
        .feature-card.lazy-load:nth-child(1) { transition-delay: 0.1s; }
        .feature-card.lazy-load:nth-child(2) { transition-delay: 0.2s; }
        .feature-card.lazy-load:nth-child(3) { transition-delay: 0.3s; }
        .feature-card.lazy-load:nth-child(4) { transition-delay: 0.1s; }
        .feature-card.lazy-load:nth-child(5) { transition-delay: 0.2s; }
        .feature-card.lazy-load:nth-child(6) { transition-delay: 0.3s; }
        /* Stagger How-to-use steps */
        #how-to-use ol li.lazy-load:nth-child(1) { transition-delay: 0.1s; }
        #how-to-use ol li.lazy-load:nth-child(2) { transition-delay: 0.2s; }
        #how-to-use ol li.lazy-load:nth-child(3) { transition-delay: 0.3s; }
        /* Stagger Tech Stack items */
        #tech-stack ul li.lazy-load:nth-child(1) { transition-delay: 0.1s; }
        #tech-stack ul li.lazy-load:nth-child(2) { transition-delay: 0.2s; }
        #tech-stack ul li.lazy-load:nth-child(3) { transition-delay: 0.3s; }
        #tech-stack ul li.lazy-load:nth-child(4) { transition-delay: 0.4s; }


        /* Contact page */
        .page-section { display: block; }
        .page-section.hidden { display: none; }
        #contact-page { min-height: 60vh; }

        /* Section Bottom Fade Effects */
        #hero::after, #features::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 100px; pointer-events: none; z-index: 5; }
        #hero::after { background: linear-gradient(to bottom, transparent, var(--hero-fade-color)); }
        #features::after { background: linear-gradient(to bottom, transparent, var(--features-fade-color)); }
        /* Define fade colors */
        body { --hero-fade-color: #f0fdf4; /* emerald-50 */ --features-fade-color: #f9fafb; /* gray-50 */ }
        body.dark { --hero-fade-color: #1f2937; /* gray-800 */ --features-fade-color: #1f2937; /* gray-800 */ }


        /* Stylish Curvy Underline */
        .stylish-underline { position: relative; display: inline-block; }
        .stylish-underline::after { content: ''; position: absolute; bottom: -8px; left: 0; right: 0; height: 8px; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 10'%3E%3Cpath d='M0,5 Q25,10 50,5 T100,5' fill='none' stroke='%2310b981' stroke-width='2'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-size: contain; background-position: center bottom; }
        .dark .stylish-underline::after { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 10'%3E%3Cpath d='M0,5 Q25,10 50,5 T100,5' fill='none' stroke='%2334d399' stroke-width='2'/%3E%3C/svg%3E"); }
        h1 .stylish-underline::after { bottom: -16px; height: 18px; }
        h2 .stylish-underline::after { bottom: -10px; height: 9px; }

    </style>
    <script>
        // Tailwind config
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: { light: '#a7f3d0', DEFAULT: '#10b981', dark: '#047857' },
                        bglight: '#f9fafb', bgdark: '#1f2937',
                        textlight: '#111827', textdark: '#f3f4f6',
                        'hero-fade-light': '#f0fdf4', 'hero-fade-dark': '#1f2937',
                        'features-fade-light': '#f9fafb', 'features-fade-dark': '#1f2937',
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] },
                    gradientColorStops: theme => ({ ...theme('colors'), 'primary-grad-start': '#34d399', 'primary-grad-end': '#059669', 'dark-grad-start': '#1f2937', 'dark-grad-end': '#111827' }),
                }
            }
        }
    </script>
</head>
<body class="bg-bglight text-textlight dark:bg-bgdark dark:text-textdark font-sans antialiased">

    <nav id="navbar" class="fixed top-0 left-0 right-0 z-50 transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex-shrink-0 flex items-center"><a href="./" class="flex items-center">
                     <!-- <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="w-8 h-8 text-primary mr-2"><text y=".9em" font-size="90">🦊</text></svg> -->
                    <img src="./assets/img/logo/lazyfox.png" alt="Lazyfox AI Logo" class="w-8 h-8 mr-2">
                    <span class="text-xl font-bold text-gray-800 dark:text-white">Lazyfox AI</span>
                </a>
                </div>

                <div class="hidden md:flex items-center space-x-4">
                    <a href="#hero" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">Home</a>
                    <a href="#chat" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">Chat</a>
                    <a href="#features" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">Features</a>
                    <a href="#how-to-use" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">How to Use</a>
                    <a href="#tech-stack" class="nav-link text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">Tech</a>
                    <a href="#contact-page" id="contact-link" class="text-gray-600 dark:text-gray-300 hover:text-primary dark:hover:text-primary-light px-3 py-2 rounded-md text-sm font-medium">Contact</a>
                    <button id="theme-toggle" class="p-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 hidden dark:inline -mt-1" id="theme-toggle-sun">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                          </svg>                          
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 inline dark:hidden -mt-1" id="theme-toggle-moon">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                          
                    </button>
                </div>

                <div class="md:hidden flex items-center">
                    <button id="theme-toggle-mobile" class="p-2 mr-2 rounded-md text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 inline dark:hidden -mt-2" id="theme-toggle-moon">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-5 h-5 hidden dark:inline -mt-2" id="theme-toggle-sun">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M21.752 15.002A9.72 9.72 0 0 1 18 15.75c-5.385 0-9.75-4.365-9.75-9.75 0-1.33.266-2.597.748-3.752A9.753 9.753 0 0 0 3 11.25C3 16.635 7.365 21 12.75 21a9.753 9.753 0 0 0 9.002-5.998Z" />
                          </svg>                          
                    </button>
                    <button id="mobile-menu-button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-600 dark:text-gray-300 hover:text-white hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white">
                        <span class="sr-only">Open main menu</span>
                        <i id="hamburger-icon" class="fa-solid fa-bars h-6 w-6 block"></i>
                        <i id="close-icon" class="fa-solid fa-xmark h-6 w-6 hidden"></i>
                    </button>
                </div>
            </div>
        </div>

        <div id="mobile-menu" class="md:hidden hidden bg-white dark:bg-gray-900 mobile-nav-bg">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#hero" class="nav-link text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">Home</a>
                <a href="#chat" class="nav-link text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">Chat</a>
                <a href="#features" class="nav-link text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">Features</a>
                <a href="#how-to-use" class="nav-link text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">How to Use</a>
                <a href="#tech-stack" class="nav-link text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">Tech</a>
                <a href="#contact-page" id="contact-link-mobile" class="text-gray-600 dark:text-gray-300 hover:bg-primary-light dark:hover:bg-primary-dark hover:text-gray-900 dark:hover:text-white block px-3 py-2 rounded-md text-base font-medium">Contact</a>
            </div>
        </div>
    </nav>

    <main id="main-content">
        <section id="hero" class="page-section relative min-h-screen flex items-center justify-center bg-gradient-to-br from-emerald-100 via-white to-emerald-200 dark:from-dark-grad-start dark:via-gray-900 dark:to-dark-grad-end overflow-hidden">
            <div class="absolute inset-0 opacity-20 dark:opacity-10">
                <svg width="100%" height="100%" xmlns="http://www.w3.org/2000/svg"><defs><pattern id="patt" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="1" fill="currentColor" class="text-primary opacity-50"></circle></pattern></defs><rect width="100%" height="100%" fill="url(#patt)"></rect></svg>
            </div>
            <div class="container mx-auto px-6 text-center relative z-10 lazy-load">
                <h1 class="text-4xl md:text-6xl font-bold text-gray-800 dark:text-white mb-4 leading-tight">
                    Experience the Future of <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary-grad-start to-primary-grad-end stylish-underline">Conversation</span>
                </h1>
                <p class="text-lg md:text-2xl font-medium text-primary dark:text-primary-light mb-8">Intelligent, Fast, and Code-Savvy AI Chat.</p>
                <p class="text-base md:text-lg text-gray-600 dark:text-gray-300 mb-10 max-w-3xl mx-auto">
                    Engage with the powerful Deepseek V3 Turbo model through Lazyfox AI. Get instant answers, generate creative text, understand complex topics, and interact with code seamlessly. Powered by Novita.ai.
                </p>
                <a href="#chat" class="bg-gradient-to-r from-primary-grad-start to-primary-grad-end hover:opacity-90 text-white font-bold py-3 px-8 rounded-full text-lg transition duration-300 ease-in-out transform hover:scale-105 shadow-lg inline-block">
                    Start Chatting Now <i class="fa-solid fa-arrow-right ml-2"></i>
                </a>

                <div class="mt-16 md:mt-20 grid grid-cols-1 sm:grid-cols-3 gap-8 max-w-4xl mx-auto text-left">
                    <div class="flex items-center space-x-4 p-4 rounded-lg bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm lazy-load" style="transition-delay: 0.2s;">
                        <div class="flex-shrink-0 text-primary text-3xl"><i class="fa-solid fa-bolt-lightning"></i></div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-1">Lightning Fast</h3>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Rapid responses via Deepseek V3 Turbo.</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4 p-4 rounded-lg bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm lazy-load" style="transition-delay: 0.3s;">
                        <div class="flex-shrink-0 text-primary text-3xl"><i class="fa-solid fa-comments"></i></div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-1">Intelligent Dialogue</h3>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Natural, context-aware conversations.</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-4 p-4 rounded-lg bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm lazy-load" style="transition-delay: 0.4s;">
                        <div class="flex-shrink-0 text-primary text-3xl"><i class="fa-solid fa-code"></i></div>
                        <div>
                            <h3 class="text-md font-semibold text-gray-800 dark:text-white mb-1">Code Savvy</h3>
                            <p class="text-gray-600 dark:text-gray-400 text-sm">Generate & discuss code with ease.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="chat" class="page-section py-16 md:py-24 bg-bglight dark:bg-bgdark lazy-load">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-4">Lazyfox AI Chat</h2>
                <p class="text-center text-gray-600 dark:text-gray-300 mb-10">Using Deepseek V3 Turbo model. Type your message below!</p>

                <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden border border-gray-200 dark:border-gray-700">
                    <div id="chat-history" class="h-96 p-4 overflow-y-auto space-y-4 flex flex-col">
                    </div>
                    <div class="p-4 border-t border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800">
                        <div class="flex items-center space-x-3">
                            <input type="text" id="user-input" placeholder="Type your message..." class="flex-grow px-4 py-2 border border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-primary dark:focus:ring-primary-light bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400" autocomplete="off">
                            <button id="send-button" class="bg-primary hover:bg-primary-dark text-white p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary dark:focus:ring-offset-gray-800 transition duration-150 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0 w-10 h-10 flex items-center justify-center">
                                <i class="fa-solid fa-paper-plane w-5 h-5"></i>
                            </button>
                        </div>
                         <div id="loading-indicator" class="mt-2 text-sm text-gray-500 dark:text-gray-400 flex items-center hidden justify-center">
                            <div class="loader mr-2"></div>
                            <span>Lazyfox AI is thinking...</span>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="features" class="page-section relative py-16 md:py-24 bg-emerald-50 dark:bg-emerald-900/30 overflow-hidden">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 lazy-load">
                <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-12">
                    Why Choose <span class="stylish-underline">Lazyfox AI</span>?
                </h2>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                    <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                        <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-microchip fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Dedicated Model</h3>
                        <p class="text-gray-600 dark:text-gray-300">Focused experience using the powerful Deepseek V3 Turbo model.</p>
                    </div>
                     <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                         <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-bolt fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Fast & Responsive</h3>
                        <p class="text-gray-600 dark:text-gray-300">Quick interactions via Novita.ai's optimized API.</p>
                    </div>
                     <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                         <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-wand-magic-sparkles fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Sleek Interface</h3>
                        <p class="text-gray-600 dark:text-gray-300">Modern design with light/dark modes & syntax highlighting.</p>
                    </div>
                    <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                         <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-brain fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Context Aware</h3>
                        <p class="text-gray-600 dark:text-gray-300">Remembers previous parts of the conversation for relevance.</p>
                    </div>
                     <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                         <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-lightbulb fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">Creative Generation</h3>
                        <p class="text-gray-600 dark:text-gray-300">Generate ideas, draft text, explain concepts, and more.</p>
                    </div>
                     <div class="feature-card lazy-load p-6 rounded-lg shadow-lg text-center transform hover:scale-105 transition duration-300">
                         <div class="mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-primary-light dark:bg-primary-dark text-primary dark:text-primary-light"><i class="fa-solid fa-mobile-screen-button fa-lg"></i></div>
                        <h3 class="text-xl font-semibold text-gray-900 dark:text-white mb-2">User-Friendly</h3>
                        <p class="text-gray-600 dark:text-gray-300">Simple, intuitive chat interface suitable for everyone.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="how-to-use" class="page-section py-16 md:py-24 bg-bglight dark:bg-bgdark lazy-load">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-12">
                    <span class="stylish-underline">How It Works</span>
                </h2>
                <ol class="relative border-l border-gray-200 dark:border-gray-700 space-y-10 ml-4">
                     <li class="ml-6 lazy-load">
                        <span class="absolute flex items-center justify-center w-8 h-8 bg-primary-light rounded-full -left-4 ring-8 ring-white dark:ring-gray-900 dark:bg-primary-dark -ml-6"><span class="font-bold text-primary dark:text-primary-light">1</span></span>
                        <h3 class="mb-1 text-lg font-semibold text-gray-900 dark:text-white">Start Chatting</h3>
                        <p class="text-base font-normal text-gray-500 dark:text-gray-400">Type your message in the input field and press Enter or click send (<i class="fa-solid fa-paper-plane text-xs"></i>).</p>
                    </li>
                     <li class="ml-6 lazy-load">
                        <span class="absolute flex items-center justify-center w-8 h-8 bg-primary-light rounded-full -left-4 ring-8 ring-white dark:ring-gray-900 dark:bg-primary-dark -ml-6"><span class="font-bold text-primary dark:text-primary-light">2</span></span>
                        <h3 class="mb-1 text-lg font-semibold text-gray-900 dark:text-white">View Response</h3>
                        <p class="text-base font-normal text-gray-500 dark:text-gray-400">The AI's response appears. Code blocks are highlighted with a copy button (<i class="fa-regular fa-copy text-xs"></i>).</p>
                     </li>
                     <li class="ml-6 lazy-load">
                        <span class="absolute flex items-center justify-center w-8 h-8 bg-primary-light rounded-full -left-4 ring-8 ring-white dark:ring-gray-900 dark:bg-primary-dark -ml-6"><span class="font-bold text-primary dark:text-primary-light">3</span></span>
                        <h3 class="mb-1 text-lg font-semibold text-gray-900 dark:text-white">Copy Code</h3>
                        <p class="text-base font-normal text-gray-500 dark:text-gray-400">Hover over code and click the copy icon (<i class="fa-regular fa-copy text-xs"></i>) to copy it instantly.</p>
                     </li>
                </ol>
            </div>
        </section>

        <section id="tech-stack" class="page-section py-16 md:py-24 bg-gray-100 dark:bg-gray-900 lazy-load">
             <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-12">Technology Stack</h2>
                <p class="text-center text-gray-600 dark:text-gray-300 mb-10">Built with modern web technologies for a fast and reliable experience.</p>
                <ul class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                    <li class="lazy-load">
                        <div class="text-4xl text-orange-600 mb-2"><i class="fa-brands fa-html5"></i></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">HTML5</h3>
                    </li>
                     <li class="lazy-load">
                        <div class="text-4xl text-blue-500 mb-2"><i class="fa-brands fa-css3-alt"></i></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">CSS3</h3>
                    </li>
                     <li class="lazy-load">
                        <div class="text-4xl text-blue-500 mb-2"><img src="https://img.icons8.com/?size=256&id=4PiNHtUJVbLs&format=png" alt="Tailwind" class="size-10 ml-auto mr-auto"></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">Tailwind</h3>
                    </li>
                     <li class="lazy-load">
                        <div class="text-4xl text-yellow-500 mb-2"><i class="fa-brands fa-js-square"></i></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">JavaScript</h3>
                    </li>
                    <li class="lazy-load">
                        <div class="text-4xl text-blue-500 mb-2"><img src="https://highlightjs.org/icon.png" alt="Highlight JS" class="size-10 ml-auto mr-auto"></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">Highlight JS</h3>
                    </li>
                     <li class="lazy-load">
                        <div class="text-4xl text-blue-500 mb-2"><img src="https://novita.ai/favicon-dark.ico" alt="Novita" class="size-10 ml-auto mr-auto"></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">Novita.ai</h3>
                    </li>
                     <li class="lazy-load">
                        <div class="text-4xl text-blue-500 mb-2"><img src="https://img.icons8.com/?size=256&id=YWOidjGxCpFW&format=png" alt="Deepseek" class="size-10 ml-auto mr-auto"></div>
                        <h3 class="text-lg font-semibold text-gray-700 dark:text-gray-200">Deepseek</h3>
                    </li>
                </ul>
            </div>
        </section>

        <section id="contact-page" class="page-section py-16 md:py-24 bg-bglight dark:bg-bgdark hidden">
            <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
                <h2 class="text-3xl font-bold text-center text-gray-800 dark:text-white mb-12">Contact Us</h2>
                <p class="text-center text-gray-600 dark:text-gray-300 mb-10">Get in touch with Lazyfox AI.</p>
                <form class="max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-lg shadow-md border dark:border-gray-700">
                    <div class="mb-4">
                        <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Name</label>
                        <input type="text" id="name" name="name" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary dark:focus:ring-primary-light bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                    <div class="mb-4">
                        <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Email</label>
                        <input type="email" id="email" name="email" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary dark:focus:ring-primary-light bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                    <div class="mb-6">
                        <label for="message" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Message</label>
                        <textarea id="message" name="message" rows="4" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-primary dark:focus:ring-primary-light bg-gray-50 dark:bg-gray-700 text-gray-900 dark:text-white"></textarea>
                    </div>
                    <div class="text-center">
                        <button type="submit" class="bg-primary hover:bg-primary-dark text-white font-bold py-2 px-6 rounded-md transition duration-300">Send Message</button>
                    </div>
                </form>
                <div class="text-center mt-8">
                     <button id="back-to-main" class="text-primary hover:underline">← Back to Main Site</button>
                 </div>
            </div>
        </section>
    </main>


    <footer class="bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
        <div class="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8 text-center">
            <p class="text-gray-500 dark:text-gray-400 text-sm">
                &copy; 2025 Lazyfox AI, All rights reserved. <br> Powered by <a href="https://novita.ai/" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline">Novita.ai</a>. <br> Developer: <a href="https://kabir.pages.dev" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline">Kabir</a>
            </p>
             <p class="text-xs text-gray-400 dark:text-gray-500 mt-2">
                Disclaimer: Chat history is lost on page refresh. Do not share sensitive information. API key embedded client-side (insecure for production).
            </p>
        </div>
    </footer>

    <button id="back-to-top" title="Go to top">
        <i class="fa-solid fa-arrow-up"></i>
    </button>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/apache.min.js"></script>
    <script>
        // --- DOM Elements ---
        const navbar = document.getElementById('navbar');
        const themeToggleButton = document.getElementById('theme-toggle');
        const themeToggleButtonMobile = document.getElementById('theme-toggle-mobile');
        const themeToggleSunIcon = document.getElementById('theme-toggle-sun');
        const themeToggleMoonIcon = document.getElementById('theme-toggle-moon');
        const themeToggleSunIconMobile = document.getElementById('theme-toggle-sun-mobile');
        const themeToggleMoonIconMobile = document.getElementById('theme-toggle-moon-mobile');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const hamburgerIcon = document.getElementById('hamburger-icon');
        const closeIcon = document.getElementById('close-icon');
        const chatHistory = document.getElementById('chat-history');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const loadingIndicator = document.getElementById('loading-indicator');
        const backToTopButton = document.getElementById('back-to-top');
        const mainContent = document.getElementById('main-content');
        const contactPageSection = document.getElementById('contact-page');
        const contactLink = document.getElementById('contact-link');
        const contactLinkMobile = document.getElementById('contact-link-mobile');
        const backToMainButton = document.getElementById('back-to-main');
        const pageSections = document.querySelectorAll('.page-section');
        const navLinks = document.querySelectorAll('.nav-link');

        // --- State ---
        let currentTheme = localStorage.getItem('theme') || 'light';
        let conversationHistory = [
             { role: "assistant", content: "Hello! I'm Lazyfox AI 😊, using the Deepseek V3 Turbo model. How can I help you today?" }
        ];

        // --- Constants ---
        const NOVITA_API_BASE_URL = "https://api.novita.ai/v3/openai/chat/completions";
        const USE_STREAMING = false;
        const CHAT_MODEL = "deepseek/deepseek-v3-turbo";
        // --- !!! SECURITY WARNING !!! ---
        const NOVITA_API_KEY = "sk_FGitgRsXP5R5ol1MwpJr5By4Ch0cNgnv7iJPVT5FXEM"; // Replace if needed
        // --- !!! END SECURITY WARNING !!! ---

        // --- Functions ---

        /** Apply Theme **/
        const applyTheme = (theme) => {
            const root = document.documentElement;
            const body = document.body;
            const isDark = theme === 'dark';

            root.classList.toggle('dark', isDark);
            body.classList.toggle('dark', isDark);
            themeToggleSunIcon?.classList.toggle('hidden', !isDark);
            themeToggleMoonIcon?.classList.toggle('hidden', isDark);
            themeToggleSunIconMobile?.classList.toggle('hidden', !isDark);
            themeToggleMoonIconMobile?.classList.toggle('hidden', isDark);

            // Update CSS variables for fade effects
            body.style.setProperty('--hero-fade-color', isDark ? tailwind.config.theme.extend.colors['hero-fade-dark'] : tailwind.config.theme.extend.colors['hero-fade-light']);
            body.style.setProperty('--features-fade-color', isDark ? tailwind.config.theme.extend.colors['features-fade-dark'] : tailwind.config.theme.extend.colors['features-fade-light']);

            currentTheme = theme;
        };

        /** Toggle Theme **/
        const toggleTheme = () => {
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            localStorage.setItem('theme', newTheme);
            applyTheme(newTheme);
        };

        /** Toggle Mobile Menu **/
        const toggleMobileMenu = () => {
            const isHidden = mobileMenu?.classList.toggle('hidden');
            hamburgerIcon?.classList.toggle('hidden', !isHidden);
            closeIcon?.classList.toggle('hidden', isHidden);

            const mobileNavBg = mobileMenu;
            if (mobileNavBg && !isHidden && window.scrollY > 50) {
                 mobileNavBg.style.backgroundColor = currentTheme === 'dark' ? 'rgba(31, 41, 55, 0.8)' : 'rgba(255, 255, 255, 0.8)';
                 mobileNavBg.style.backdropFilter = 'blur(10px)';
                 mobileNavBg.style.webkitBackdropFilter = 'blur(10px)';
            } else if (mobileNavBg) {
                 mobileNavBg.style.backgroundColor = '';
                 mobileNavBg.style.backdropFilter = '';
                 mobileNavBg.style.webkitBackdropFilter = '';
            }
        };

        /** Escape HTML **/
        const escapeHtml = (unsafe) => {
            if (typeof unsafe !== 'string') return '';
            return unsafe.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
         }

        /** Add Copy Button to Code Blocks **/
        const addCopyButton = (preElement) => {
            const codeElement = preElement.querySelector('code');
            if (!codeElement || preElement.querySelector('.copy-code-button')) return;

            const copyButton = document.createElement('button');
            copyButton.className = 'copy-code-button';
            copyButton.innerHTML = '<i class="fa-regular fa-copy"></i> Copy';
            preElement.appendChild(copyButton);

            copyButton.addEventListener('click', (e) => {
                e.stopPropagation();
                navigator.clipboard.writeText(codeElement.textContent).then(() => {
                    copyButton.innerHTML = '<i class="fa-solid fa-check"></i> Copied!';
                    copyButton.classList.add('copied');
                    setTimeout(() => {
                        copyButton.innerHTML = '<i class="fa-regular fa-copy"></i> Copy';
                        copyButton.classList.remove('copied');
                    }, 2000);
                }).catch(err => {
                    console.error('Failed to copy code: ', err);
                    copyButton.textContent = 'Error';
                     setTimeout(() => { copyButton.innerHTML = '<i class="fa-regular fa-copy"></i> Copy'; }, 2000);
                });
            });
        };

        /** Add Message to Chat **/
        const addMessageToChat = (sender, message) => {
            const messageElement = document.createElement('div');
            messageElement.classList.add('p-3', 'rounded-lg', 'shadow-sm', 'text-sm', 'relative', 'mb-4', 'w-fit', 'max-w-full', 'sm:max-w-xl', 'md:max-w-2xl', 'lg:max-w-3xl'); // Adjusted shadow

            let formattedMessage = message;
            let containsCode = false;
            // Regex to find ```lang\ncode\n``` OR ```\ncode\n``` OR ```lang code```
            const codeBlockRegex = /```(\w+)?\s*([\s\S]*?)```/g;

            formattedMessage = formattedMessage.replace(codeBlockRegex, (match, lang, code) => {
                containsCode = true;
                // Normalize language identifier (e.g., htaccess -> apache)
                let language = lang ? lang.trim().toLowerCase() : 'plaintext';
                if (language === 'htaccess') language = 'apache'; // Map htaccess to apache for highlight.js
                const trimmedCode = code.trim();
                const escapedCode = escapeHtml(trimmedCode);
                // Add language- class for highlight.js
                return `<pre><code class="language-${language}">${escapedCode}</code></pre>`;
            });

            // Handle basic Markdown and newlines outside code blocks
            const parts = formattedMessage.split(/(<pre><code.*?>.*?<\/code><\/pre>)/s);
            let finalHtml = '';
            for (const part of parts) {
                if (part.startsWith('<pre>')) {
                    finalHtml += part; // Add code block directly
                } else if (part.trim()) {
                     let textPart = escapeHtml(part);
                     textPart = textPart.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
                     textPart = textPart.replace(/\*(.*?)\*/g, '<em>$1</em>');
                     textPart = textPart.replace(/\\n|\n/g, '<br>');
                     finalHtml += `<p class="text-gray-900 dark:text-white mb-2 last:mb-0">${textPart}</p>`;
                 }
             }
            formattedMessage = finalHtml.trim() ? finalHtml : `<p class="text-gray-900 dark:text-white">${escapeHtml(message)}</p>`; // Fallback

            if (sender === 'user') {
                messageElement.classList.add('user-message', 'ml-auto', 'bg-emerald-100', 'dark:bg-emerald-800');
                messageElement.innerHTML = `<p class="text-gray-900 dark:text-white">${escapeHtml(message)}</p>`; // User messages don't need complex formatting
            } else { // AI message
                messageElement.classList.add('ai-message', 'mr-auto', 'bg-gray-100', 'dark:bg-gray-700');
                messageElement.innerHTML = formattedMessage;
            }

            chatHistory?.appendChild(messageElement);

            // Highlight code blocks AFTER they are in the DOM
            if (containsCode && sender !== 'user' && typeof hljs !== 'undefined') {
                messageElement.querySelectorAll('pre code').forEach((block) => {
                    try {
                        hljs.highlightElement(block); // Apply highlighting
                        if (block.parentElement && block.parentElement.tagName === 'PRE') {
                            addCopyButton(block.parentElement); // Add copy button
                        }
                    } catch (error) { console.error("Highlight.js error:", error); }
                 });
            }

            // Scroll to bottom if user is near the bottom
            if (chatHistory && (chatHistory.scrollHeight - chatHistory.scrollTop <= chatHistory.clientHeight + 150)) { // Increased tolerance
                 chatHistory.scrollTo({ top: chatHistory.scrollHeight, behavior: 'smooth' });
            }
        };


        /** Show/Hide Loading Indicator **/
        const showLoading = (isLoading) => {
            loadingIndicator?.classList.toggle('hidden', !isLoading);
            if (sendButton) sendButton.disabled = isLoading;
            if (userInput) userInput.disabled = isLoading;
            if (!isLoading) userInput?.focus();
        };

        /** Send Message to API **/
        const sendMessageToAPI = async () => {
            const userMessage = userInput?.value.trim();
            if (!userMessage) return;

            if (!NOVITA_API_KEY || NOVITA_API_KEY === "YOUR_NOVITA_API_KEY_HERE" || NOVITA_API_KEY.length < 10) {
                addMessageToChat('ai', '⚠️ API Key not configured correctly. Please check the script.');
                console.error("API Key issue."); return;
            }

            addMessageToChat('user', userMessage);
            conversationHistory.push({ role: "user", content: userMessage });
            if (userInput) userInput.value = '';
            showLoading(true);

            try {
                const response = await fetch(NOVITA_API_BASE_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${NOVITA_API_KEY}` },
                    body: JSON.stringify({ model: CHAT_MODEL, messages: conversationHistory, stream: USE_STREAMING })
                });

                if (!response.ok) {
                    let errorData; try { errorData = await response.json(); } catch (e) { errorData = { detail: `Request failed: ${response.status}` }; }
                    console.error('API Error:', response.status, errorData);
                    let errorMessage = `API Error (${response.status})`;
                     if (errorData?.detail) { errorMessage += `: ${typeof errorData.detail === 'string' ? errorData.detail : JSON.stringify(errorData.detail)}`; }
                     else if (errorData?.message) { errorMessage += `: ${errorData.message}`; }
                     else { errorMessage += `: ${response.statusText || 'Unknown error'}`; }
                     if (response.status === 401) errorMessage += " (Check API Key)";
                    addMessageToChat('ai', `❌ ${errorMessage}`);
                    conversationHistory.pop();
                    showLoading(false); return;
                }

                // --- Handle Non-Streaming Response ---
                if (!USE_STREAMING) {
                    const data = await response.json();
                    if (data.choices && data.choices[0].message?.content) {
                        const aiMessage = data.choices[0].message.content;
                        addMessageToChat('ai', aiMessage);
                        conversationHistory.push({ role: "assistant", content: aiMessage });
                    } else { addMessageToChat('ai', '🤔 Unexpected response format.'); }
                } else {
                    // --- Handle Streaming Response ---
                    const reader = response.body.getReader();
                    const decoder = new TextDecoder();
                    let streamedContent = "";
                    const tempMessageElement = document.createElement('div'); // Create placeholder
                    tempMessageElement.classList.add('ai-message', 'p-3', 'rounded-lg', 'shadow-sm', 'text-sm', 'bg-gray-100', 'dark:bg-gray-700', 'mr-auto', 'mb-4', 'w-fit', 'max-w-full', 'sm:max-w-xl', 'md:max-w-2xl', 'lg:max-w-3xl');
                    tempMessageElement.innerHTML = '<p class="text-gray-900 dark:text-white"></p>';
                    chatHistory?.appendChild(tempMessageElement);
                    const streamPara = tempMessageElement.querySelector('p');

                    while (true) {
                        const { value, done } = await reader.read();
                        if (done) break;
                        const chunk = decoder.decode(value, { stream: true });
                        const lines = chunk.split('\n');
                        lines.forEach(line => {
                            if (line.startsWith('data: ')) {
                                const jsonData = line.substring(6).trim();
                                if (jsonData !== '[DONE]') {
                                    try {
                                        const parsed = JSON.parse(jsonData);
                                        if (parsed.choices && parsed.choices[0]?.delta?.content) {
                                            const contentChunk = parsed.choices[0].delta.content;
                                            streamedContent += contentChunk;
                                            if (streamPara) streamPara.textContent += contentChunk;
                                            if (chatHistory && (chatHistory.scrollHeight - chatHistory.scrollTop <= chatHistory.clientHeight + 150)) {
                                                 chatHistory.scrollTo({ top: chatHistory.scrollHeight, behavior: 'auto' });
                                            }
                                        }
                                    } catch (e) { /* Ignore */ }
                                }
                            }
                        });
                     }
                    tempMessageElement.remove(); // Remove placeholder
                    addMessageToChat('ai', streamedContent); // Add final formatted message
                    conversationHistory.push({ role: "assistant", content: streamedContent });
                }

            } catch (error) {
                console.error('Network/other error:', error);
                addMessageToChat('ai', `❌ Error: ${error.message}. Check console.`);
                if (!USE_STREAMING && conversationHistory.length > 1 && conversationHistory[conversationHistory.length-1].role === 'user') {
                    conversationHistory.pop();
                }
            } finally {
                showLoading(false);
            }
        };

        /** Handle Navbar Scroll **/
        const handleNavScroll = () => { navbar?.classList.toggle('scrolled', window.scrollY > 50); };

        /** Handle Back to Top Button Visibility **/
        const handleBackToTopVisibility = () => { backToTopButton?.classList.toggle('show', window.scrollY > 300); };

        /** Scroll To Top **/
        const scrollToTop = () => { window.scrollTo({ top: 0, behavior: 'smooth' }); };

        /** Lazy Load Animation Observer **/
        const lazyLoadObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.1 }); // Adjust threshold if needed

        /** Show/Hide Contact Page **/
        const showContactPage = (show) => {
             pageSections.forEach(section => section.classList.toggle('hidden', show || section.id === 'contact-page'));
             contactPageSection?.classList.toggle('hidden', !show);
             if (show) {
                 window.scrollTo(0, 0);
                 if (!mobileMenu?.classList.contains('hidden')) toggleMobileMenu();
             }
        };


        // --- Event Listeners ---
        themeToggleButton?.addEventListener('click', toggleTheme);
        themeToggleButtonMobile?.addEventListener('click', toggleTheme);
        mobileMenuButton?.addEventListener('click', toggleMobileMenu);

        // Close mobile menu when a standard link is clicked
        mobileMenu?.querySelectorAll('a').forEach(link => { // Include all mobile links now
            link.addEventListener('click', (e) => {
                if (!mobileMenu?.classList.contains('hidden')) toggleMobileMenu();
                if (link.id !== 'contact-link-mobile') {
                    showContactPage(false); // Hide contact if showing main section
                    // Handle smooth scroll for mobile links too
                    const targetId = link.getAttribute('href');
                    if (targetId.startsWith('#') && targetId !== '#contact-page') {
                         e.preventDefault(); // Prevent default jump
                         const targetElement = document.querySelector(targetId);
                         if(targetElement) {
                            const navbarHeight = navbar?.offsetHeight || 64;
                            const targetPosition = targetElement.offsetTop - navbarHeight;
                            window.scrollTo({ top: targetPosition, behavior: 'smooth' });
                         }
                    }
                } else {
                    e.preventDefault(); // Prevent default jump for contact mobile link
                    showContactPage(true);
                }
            });
        });

        // Send message listeners
        sendButton?.addEventListener('click', sendMessageToAPI);
        userInput?.addEventListener('keypress', (event) => { if (event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); sendMessageToAPI(); } });

        // Scroll listeners
        window.addEventListener('scroll', handleNavScroll);
        window.addEventListener('scroll', handleBackToTopVisibility);
        backToTopButton?.addEventListener('click', scrollToTop);

        // Contact Page listeners
         contactLink?.addEventListener('click', (e) => { e.preventDefault(); showContactPage(true); });
         // Mobile contact link handled above
         backToMainButton?.addEventListener('click', () => { showContactPage(false); window.scrollTo({ top: 0, behavior: 'smooth' }); });

         // Standard nav link click listener (Desktop)
         navLinks?.forEach(link => {
            link.addEventListener('click', (e) => {
                const targetId = link.getAttribute('href');
                if (targetId.startsWith('#') && targetId !== '#contact-page') {
                    e.preventDefault(); // Prevent default jump for smooth scroll
                    if (!contactPageSection?.classList.contains('hidden')) showContactPage(false);

                    const targetElement = document.querySelector(targetId);
                    if(targetElement) {
                        const navbarHeight = navbar?.offsetHeight || 64;
                        const targetPosition = targetElement.offsetTop - navbarHeight;
                        window.scrollTo({ top: targetPosition, behavior: 'smooth' });
                    }
                } else if (targetId === '#contact-page') {
                    // Already handled by separate contactLink listener
                } else {
                    // External link or non-hash link
                    if (!contactPageSection?.classList.contains('hidden')) showContactPage(false);
                }
            });
         });


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize highlight.js (ensure languages are loaded first)
            if (typeof hljs !== 'undefined') {
                 hljs.configure({ ignoreUnescapedHTML: true }); // Good practice
                 // No need to call highlightAll automatically if we do it per message
            } else {
                console.warn("highlight.js not loaded.");
            }

            applyTheme(currentTheme); // Apply theme first
            handleNavScroll();
            handleBackToTopVisibility();

            // Render initial AI message
            if (conversationHistory.length > 0) {
                addMessageToChat('assistant', conversationHistory[0].content);
            }

            // Initialize lazy loading for all elements with the class
            document.querySelectorAll('.lazy-load').forEach(el => {
                lazyLoadObserver.observe(el);
            });

            // Ensure initial page state
            showContactPage(false);

            // Handle initial URL hash scrolling
            if (window.location.hash) {
                const targetId = window.location.hash;
                const targetElement = document.querySelector(targetId);
                 if(targetElement && targetId !== '#contact-page') {
                    const navbarHeight = navbar?.offsetHeight || 64;
                    const targetPosition = targetElement.offsetTop - navbarHeight;
                    setTimeout(() => { window.scrollTo({ top: targetPosition, behavior: 'auto' }); }, 100);
                } else if (targetId === '#contact-page') {
                    showContactPage(true);
                }
            }
        });

    </script>

</body>
</html>
